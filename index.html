<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Diriyah (Saudi Arabia) by Augmento</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Unity WebGL Loader -->
    <script src="WebGL_brotli/Build/WebGL.loader.js"></script>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen">
        <div class="loader-content">
            <div class="logo-loader">
                <div class="logo-container">
                    <!-- White outline logo -->
                    <img src="logo.svg" alt="Augmento" class="logo-outline">
                    <!-- Purple filled logo (clipped by progress) -->
                    <div class="logo-fill-wrapper" id="logo-fill-wrapper">
                        <img src="logo.svg" alt="Augmento" class="logo-fill">
                    </div>
                </div>
            </div>
            <span id="progress-text">0%</span>
        </div>
    </div>

    <!-- Unity 3D Canvas -->
    <canvas id="unity-canvas" tabindex="-1"></canvas>

    <!-- UI Overlay -->
    <div id="ui-overlay">

        <!-- Bottom Info Panel -->
        <div class="bottom-panel">
            <div class="project-info">
                <h1 class="project-title">Diriyah Media & Innovation District</h1>
                <a href="#" class="register-btn" id="register-btn">
                    REGISTER INTEREST
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </a>
            </div>
        </div>

        <!-- Powered By Footer -->
        <div class="powered-by">
            <span>Powered by</span>
            <img src="logo.svg" alt="Augmento" class="powered-by-logo">
        </div>
    </div>

    <!-- Settings Panel -->
    <div class="settings-panel" id="settings-panel">
        <h3>Information</h3>
        <p class="settings-info">Use your mouse or touch to interact with the 3D model:</p>
        <ul class="settings-controls">
            <li><strong>Rotate:</strong> Click and drag</li>
            <li><strong>Zoom:</strong> Scroll or pinch</li>
            <li><strong>Pan:</strong> Right-click and drag</li>
        </ul>
    </div>


    <!-- Info Popup -->
    <div class="info-popup" id="info-popup">
        <div class="info-popup-content">
            <button class="info-popup-close" id="info-popup-close">&times;</button>
            <h2>Information</h2>
            <p>Welcome to the Diriyah Media & Innovation District - a visionary development that combines cutting-edge architecture with sustainable design principles.</p>
            <p>This state-of-the-art complex features:</p>
            <ul>
                <li>Modern office spaces with panoramic views</li>
                <li>Creative studios and innovation labs</li>
                <li>Rooftop gardens and green spaces</li>
                <li>Smart building technology throughout</li>
            </ul>
            <p>Click the button below to learn more about investment opportunities.</p>
            <button class="info-popup-btn" onclick="document.getElementById('register-modal').classList.add('active'); document.getElementById('info-popup').classList.remove('active');">
                Register Interest
            </button>
        </div>
    </div>


    <!-- Register Interest Modal - Ultra Modern Glassmorphism -->
    <div class="glass-modal" id="register-modal">
        <div class="glass-modal-backdrop"></div>
        <div class="glass-modal-content">
            <button class="glass-close" id="modal-close">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </button>

            <div class="glass-header">
                <div class="glass-title-glow"></div>
                <h2 class="glass-title">Explore Diriyah</h2>
                <p class="glass-subtitle">Discover the future of real estate</p>
            </div>

            <div class="glass-buttons">
                <a href="https://diriyah.sa/?utm_source=augmento&utm_medium=3d_viewer&utm_campaign=diriyah_experience" target="_blank" class="glass-action-btn glass-btn-primary">
                    <span class="glass-btn-text">Visit Diriyah</span>
                    <div class="glass-btn-glow"></div>
                    <svg class="glass-btn-arrow" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </a>

                <a href="mailto:remy@augmento.com" class="glass-action-btn glass-btn-secondary">
                    <span class="glass-btn-text">Contact Augmento</span>
                    <svg class="glass-btn-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M3 8L10.89 13.26C11.2187 13.4793 11.6049 13.5963 12 13.5963C12.3951 13.5963 12.7813 13.4793 13.11 13.26L21 8M5 19H19C19.5304 19 20.0391 18.7893 20.4142 18.4142C20.7893 18.0391 21 17.5304 21 17V7C21 6.46957 20.7893 5.96086 20.4142 5.58579C20.0391 5.21071 19.5304 5 19 5H5C4.46957 5 3.96086 5.21071 3.58579 5.58579C3.21071 5.96086 3 6.46957 3 7V17C3 17.5304 3.21071 18.0391 3.58579 18.4142C3.96086 18.7893 4.46957 19 5 19Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </a>
            </div>
        </div>
    </div>

    <script>
        // Console error tracking
        window.addEventListener('error', function(e) {
            console.error('Global error:', e.message, e.filename, e.lineno, e.colno);
        });

        // Unity WebGL initialization
        var unityInstance = null;

        // Initialize Unity
        function initUnity() {
            const canvas = document.querySelector("#unity-canvas");
            const loadingScreen = document.getElementById('loading-screen');
            const logoFillWrapper = document.getElementById('logo-fill-wrapper');
            const progressText = document.getElementById('progress-text');

            createUnityInstance(canvas, {
                dataUrl: "WebGL_brotli/Build/WebGL.data.br",
                frameworkUrl: "WebGL_brotli/Build/WebGL.framework.js.br",
                codeUrl: "WebGL_brotli/Build/WebGL.wasm.br",
                streamingAssetsUrl: "WebGL_brotli/StreamingAssets",
                companyName: "Augmento",
                productName: "Augmento Real Estate Demo",
                productVersion: "1.0.0",
            }, (progress) => {
                // Update loading progress - fill logo from left to right
                const percent = Math.round(progress * 100);
                if (logoFillWrapper) {
                    logoFillWrapper.style.clipPath = `inset(0 ${100 - percent}% 0 0)`;
                }
                if (progressText) progressText.textContent = percent + '%';
            }).then((instance) => {
                unityInstance = instance;
                // Hide loading screen
                if (loadingScreen) {
                    loadingScreen.style.opacity = '0';
                    setTimeout(() => {
                        loadingScreen.style.display = 'none';
                    }, 500);
                }
            }).catch((message) => {
                console.error('Unity initialization error:', message);
                alert('Failed to load 3D viewer: ' + message);
            });
        }

        // Start Unity when page loads
        window.addEventListener('load', initUnity);

        // UI Controls
        document.addEventListener('DOMContentLoaded', () => {
            // Menu toggle
            const menuBtn = document.getElementById('menu-btn');
            const mobileMenu = document.getElementById('mobile-menu');
            if (menuBtn && mobileMenu) {
                menuBtn.addEventListener('click', () => {
                    mobileMenu.classList.toggle('active');
                    menuBtn.classList.toggle('active');
                });
            }

            // Settings panel toggle
            const settingsBtn = document.getElementById('settings-btn');
            const settingsPanel = document.getElementById('settings-panel');
            if (settingsBtn && settingsPanel) {
                settingsBtn.addEventListener('click', () => {
                    settingsPanel.classList.toggle('active');
                });
            }

            // Register modal
            const registerBtn = document.getElementById('register-btn');
            const registerModal = document.getElementById('register-modal');
            const modalClose = document.getElementById('modal-close');

            if (registerBtn && registerModal) {
                registerBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    registerModal.classList.add('active');
                    // Disable Unity canvas when modal opens
                    const unityCanvas = document.getElementById('unity-canvas');
                    if (unityCanvas) {
                        unityCanvas.style.pointerEvents = 'none';
                        unityCanvas.tabIndex = -1;
                    }
                });
            }

            if (modalClose && registerModal) {
                modalClose.addEventListener('click', () => {
                    registerModal.classList.remove('active');
                    // Re-enable Unity canvas when modal closes
                    const unityCanvas = document.getElementById('unity-canvas');
                    if (unityCanvas) {
                        unityCanvas.style.pointerEvents = 'auto';
                    }
                });
            }

            // Close modal on outside click
            if (registerModal) {
                registerModal.addEventListener('click', (e) => {
                    if (e.target === registerModal) {
                        registerModal.classList.remove('active');
                        // Re-enable Unity canvas
                        const unityCanvas = document.getElementById('unity-canvas');
                        if (unityCanvas) {
                            unityCanvas.style.pointerEvents = 'auto';
                        }
                    }
                });
            }

            // Info popup close
            const infoPopupClose = document.getElementById('info-popup-close');
            const infoPopup = document.getElementById('info-popup');
            if (infoPopupClose && infoPopup) {
                infoPopupClose.addEventListener('click', () => {
                    infoPopup.classList.remove('active');
                });
            }


            // Close panels with Escape key
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    if (settingsPanel) settingsPanel.classList.remove('active');
                    if (registerModal) {
                        registerModal.classList.remove('active');
                        // Re-enable Unity canvas
                        const unityCanvas = document.getElementById('unity-canvas');
                        if (unityCanvas) {
                            unityCanvas.style.pointerEvents = 'auto';
                        }
                    }
                    if (mobileMenu) {
                        mobileMenu.classList.remove('active');
                        menuBtn.classList.remove('active');
                    }
                }
            });
        });
    </script>
</body>
</html>
